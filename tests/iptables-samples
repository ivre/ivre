# IVRE SAMPLES for iptables parser
# --------------------------------
#
#    Tests cases
#
#    - samples contains lines without IN=
#    - date parser with day of month on 1 or 2 digits
#    - Some iptables syslog entries do not contains same number of information. In PROTO=2 case, there is no SPT and DPT.
#    - the data can be prefix by any kind of string. It depends on the sysadmin configuration.
#
#    Test 1, day of the month on 1 digit
#    -----------------------------------
#
Feb  9 23:52:49 pi02 kernel: [3739244.308916] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:45:34:40:00:40:11:49:2f SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=17716 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:53:19 pi02 kernel: [3739274.330973] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:47:bd:40:00:40:11:46:a6 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=18365 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:54:50 pi02 kernel: [3739365.304828] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:4d:73:40:00:40:11:40:f0 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=19827 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:55:01 pi02 kernel: [3739376.561212] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:4d:ec:40:00:40:11:40:77 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=19948 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:55:23 pi02 kernel: [3739398.548275] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:4e:14:40:00:40:11:40:4f SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=19988 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:55:53 pi02 kernel: [3739428.546176] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:50:44:40:00:40:11:3e:1f SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=20548 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:57:23 pi02 kernel: [3739518.597652] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:5c:72:40:00:40:11:31:f1 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=23666 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:57:53 pi02 kernel: [3739548.609668] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:66:bb:40:00:40:11:27:a8 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=26299 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:59:22 pi02 kernel: [3739637.741925] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:6b:52:40:00:40:11:23:11 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=27474 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
Feb  9 23:59:52 pi02 kernel: [3739667.708601] IPTABLES/UDP/IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:a8:0c:11:22:33:44:08:00:45:00:00:44:6f:7a:40:00:40:11:1e:e9 SRC=192.168.0.54 DST=255.255.255.255 LEN=68 TOS=0x00 PREC=0x00 TTL=64 ID=28538 DF PROTO=UDP SPT=57621 DPT=57621 LEN=48
#
#    Test 2, day of the month on 2 digits, PROTO=2 without SPT and DPT
#    ------------------------------------------------------------------
#
Feb 13 14:29:50 source1 kernel: [4051065.858145] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:30:30 source1 kernel: [4051105.856986] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:31:10 source1 kernel: [4051145.854809] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:31:50 source1 kernel: [4051185.852917] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:31:52 source1 kernel: [4051187.462344] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:fb:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:56:4e SRC=192.168.0.254 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:31:52 source1 kernel: [4051187.578016] IPTABLES/#1: IN=eth0 OUT= MAC=01:00:5e:00:00:fb:84:78:18:00:11:22:08:00:46:00:00:20:5d:47:00:00:01:02:3a:52 SRC=192.168.0.51 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x00 TTL=1 ID=23879 PROTO=2
Feb 13 14:32:30 source1 kernel: [4051225.851304] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:33:10 source1 kernel: [4051265.849458] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:33:13 source1 kernel: [4051269.248875] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:fb:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:56:4e SRC=192.168.0.254 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 14:33:50 source1 kernel: [4051305.847708] IPTABLES/INPUT: IN=eth0 OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
#
#    Test 3, day of the month on 2 digits, full data
#    -----------------------------------------------
#
Feb 13 14:33:05 source1 kernel: [4051260.577994] IPTABLES/#1: IN=eth0 OUT= MAC=b8:27:22:33:44:55:84:78:18:00:11:22:08:00:45:00:00:49:85:2b:00:00:ff:11:de:22 SRC=192.168.0.51 DST=192.168.0.2 LEN=73 TOS=0x00 PREC=0x00 TTL=255 ID=34091 PROTO=UDP SPT=60614 DPT=53 LEN=53
Feb 13 14:33:06 source1 kernel: [4051261.437733] IPTABLES/#1: IN=eth0 OUT= MAC=b8:27:22:33:44:55:84:78:18:00:11:22:08:00:45:00:00:4e:fb:03:00:00:ff:11:68:45 SRC=192.168.0.51 DST=192.168.0.2 LEN=78 TOS=0x00 PREC=0x00 TTL=255 ID=64259 PROTO=UDP SPT=58241 DPT=53 LEN=58
Feb 13 14:33:06 source1 kernel: [4051261.580880] IPTABLES/#1: IN=eth0 OUT= MAC=b8:27:22:33:44:55:84:78:18:00:11:22:08:00:45:00:00:49:8e:1e:00:00:ff:11:d5:2f SRC=192.168.0.51 DST=192.168.0.2 LEN=73 TOS=0x00 PREC=0x00 TTL=255 ID=36382 PROTO=UDP SPT=60614 DPT=53 LEN=53
Feb 13 14:33:07 source1 kernel: [4051262.441341] IPTABLES/#1: IN=eth0 OUT= MAC=b8:27:22:33:44:55:84:78:18:00:11:22:08:00:45:00:00:4e:b0:c5:00:00:ff:11:b2:83 SRC=192.168.0.51 DST=192.168.0.2 LEN=78 TOS=0x00 PREC=0x00 TTL=255 ID=45253 PROTO=UDP SPT=58241 DPT=53 LEN=58
Feb 13 14:33:12 source1 kernel: [4051267.574704] IPTABLES/#2: IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:4c:cc:6a:0d:ad:52:08:00:45:b8:00:48:7a:c7:00:00:80:11:65:dd SRC=192.168.0.41 DST=192.168.0.255 LEN=72 TOS=0x18 PREC=0xA0 TTL=128 ID=31431 PROTO=UDP SPT=57621 DPT=57621 LEN=52
Feb 13 14:33:26 source1 kernel: [4051281.675297] IPTABLES/#2: IN=eth0 OUT= MAC=b8:27:22:33:44:55:4c:cc:6a:0d:ad:52:08:00:45:00:00:46:0c:41:00:00:80:11:d6:1a SRC=192.168.0.41 DST=192.168.0.2 LEN=70 TOS=0x00 PREC=0x00 TTL=128 ID=3137 PROTO=UDP SPT=50664 DPT=53 LEN=50
Feb 13 14:33:38 source1 kernel: [4051294.335866] IPTABLES/#2: IN=eth0 OUT= MAC=b8:27:22:33:44:55:4c:cc:6a:0d:ad:52:08:00:45:00:01:51:0c:43:00:00:80:11:d5:0d SRC=192.168.0.41 DST=192.168.0.2 LEN=337 TOS=0x00 PREC=0x00 TTL=128 ID=3139 PROTO=UDP SPT=68 DPT=67 LEN=317
Feb 13 14:33:53 source1 kernel: [4051309.055334] IPTABLES/#2: IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:4c:cc:6a:0d:ad:52:08:00:45:b8:00:48:7a:cd:00:00:80:11:65:d7 SRC=192.168.0.41 DST=192.168.0.255 LEN=72 TOS=0x18 PREC=0xA0 TTL=128 ID=31437 PROTO=UDP SPT=57621 DPT=57621 LEN=52
Feb 13 14:34:18 source1 kernel: [4051333.716056] IPTABLES/#2: IN=eth0 OUT= MAC=b8:27:22:33:44:55:4c:cc:6a:0d:ad:52:08:00:45:00:00:51:0c:4a:00:00:80:11:d6:06 SRC=192.168.0.41 DST=192.168.0.2 LEN=81 TOS=0x00 PREC=0x00 TTL=128 ID=3146 PROTO=UDP SPT=60748 DPT=53 LEN=61
Feb 13 14:34:23 source1 kernel: [4051339.102405] IPTABLES/#2: IN=eth0 OUT= MAC=ff:ff:ff:ff:ff:ff:4c:cc:6a:0d:ad:52:08:00:45:b8:00:48:7a:d3:00:00:80:11:65:d1 SRC=192.168.0.41 DST=192.168.0.255 LEN=72 TOS=0x18 PREC=0xA0 TTL=128 ID=31443 PROTO=UDP SPT=57621 DPT=57621 LEN=52
#
#    Test 4, no iptables prefix
#    --------------------------
#
Feb 13 13:44:30 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:fb:84:78:18:00:11:22:08:00:46:00:00:20:c5:c4:00:00:01:02:d1:d4 SRC=192.168.0.51 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x00 TTL=1 ID=50628 PROTO=2
Feb 13 13:45:10 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 13:45:10 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:fb:84:78:18:00:11:22:08:00:46:00:00:20:ee:d2:00:00:01:02:a8:c6 SRC=192.168.0.51 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x00 TTL=1 ID=61138 PROTO=2
Feb 13 13:45:50 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 13:45:56 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:fb:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:56:4e SRC=192.168.0.254 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 13:46:30 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 13:46:32 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:fb:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:56:4e SRC=192.168.0.254 DST=224.0.0.251 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 13:47:10 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=01:00:5e:00:00:01:18:62:99:aa:bb:cc:08:00:46:80:00:20:00:00:40:00:01:02:57:48 SRC=192.168.0.254 DST=224.0.0.1 LEN=32 TOS=0x00 PREC=0x80 TTL=1 ID=0 DF PROTO=2
Feb 13 13:47:15 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=ff:ff:ff:ff:ff:ff:18:62:99:aa:bb:cc:08:00:45:00:00:ec:00:00:40:00:40:11:df:e3 SRC=192.168.0.254 DST=192.168.0.255 LEN=236 TOS=0x00 PREC=0x00 TTL=64 ID=0 DF PROTO=UDP SPT=138 DPT=138 LEN=216
Feb 13 13:47:15 source2 kernel: IN=enxb827eb8f8a4f OUT= MAC=ff:ff:ff:ff:ff:ff:18:62:99:aa:bb:cc:08:00:45:00:00:ec:00:00:40:00:40:11:df:e3 SRC=192.168.0.254 DST=192.168.0.255 LEN=236 TOS=0x00 PREC=0x00 TTL=64 ID=0 DF PROTO=UDP SPT=138 DPT=138 LEN=216
